# AdveRSArial Crypto (Kiddo)

| Category | Author     | Difficulty | Solves | Points |
| -------- | ---------- | ---------- | ------ | ------ |
| Crypto   | Maxime, \j | ⭐️          | 36     | 413    |

> J’ai perfectionné mes connaissances sur RSA, mais je ne suis pas sûr que ma manière creuse de générer les nombres soit intelligente. Vous confirmez ?

**Challenge files:**

- `output.txt`

## Write-up

**Introduction**

This is a classic RSA challenge featuring a sparse RSA modulus. It was already featured in the challenge [Decent RSA](https://ctftime.org/writeup/22977) from Crypto CTF 2020. 

**Exploit**

In our case the public modulus is sparse in base 2:

```console
sage: N = 1797706850172487891975376615658152699342035621208510891791224143990647
....: 34715990794430000078278988633398024403072323955508476586487162411822366599
....: 11141253453943074013719626524237112871455836208288252000174768522265586381
....: 71257336934110584527437688182679186885936483346137560451573214916072337449
....: 02053478170361857
sage: N.str(base=2)
'10000000000000000100000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000010000000000000000100010000100000000100100000000000001000000000000010000000000000000000010000000000010100000000000000100000000000000000001000000000000000110000000000010000000100000000000001000100000000001000000000100000000000001000000000000000000000000100000000000000000000000000000000000010100000010000000000000000000000000000010000000000000000001010000000000000000100000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000010000000000000000000010000000000000100100000000001000000000000000000001000000100000010000000000000010000000000000000000000000000000000001000000000001000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000001'
```

We can then write `N` as a polynomial in the following way

```
R.<X> = PolynomialRing(ZZ)
T = sum([int(a) * X^i for i, a in enumerate(N.digits(2))])
```

Which sage very quickly can factor

```console
sage: factor(T)
(X^511 + X^494 + X^445 + X^359 + X^320 + X^49 + 1) * (X^513 + X^348 + X^327 + X^313 + X^249 + X^212 + 1)
```

Setting `X = 2` will return the primes `p*q = N`, solving the challenge. Full solve in [script](wu.sage).
